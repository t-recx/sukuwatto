<div class="map" leaflet 
    (leafletMapMove)="mapMove($event)"
    (leafletMapZoom)="mapZoom($event)"
    [(leafletCenter)]="center" [leafletOptions]="options" [leafletFitBounds]="fitBounds"
    (leafletMapReady)="onMapReady($event)">
    <div *ngIf="route" [leafletLayer]="route"></div>

    <div *ngIf="allowEdit">
        <button 
            type="button"
            class="siimple-btn 
            siimple-btn--small
            siimple-btn--dark stop-tracking-button" (click)="disableTracking()">
            <fa-icon [icon]="faTimes"></fa-icon>
        </button>
    
        <button class="start-button siimple-btn siimple-btn--primary" (click)="startTracking()"
            type="button"
            *ngIf="!collectingPositions">
            <fa-icon [icon]="faPlay" class="siimple--mr-1"></fa-icon>
            {{startText}}
        </button>

        <button class="recenter-button siimple-btn siimple-btn--primary"
            type="button"
            (click)="recenter()"
            *ngIf="collectingPositions && userOperatingMap">
            <fa-icon [icon]="faDotCircle"></fa-icon>
        </button>
    
        <div class="stop-finish-bar">
            <button class="stop-button siimple-btn siimple-btn--primary" (click)="stopTracking()"
                type="button"
                *ngIf="collectingPositions">
                <fa-icon [icon]="faStop" class="siimple--mr-1"></fa-icon>
                Stop
            </button>
    
            <button class="siimple--ml-2 finish-button siimple-btn siimple-btn--success" (click)="finishActivity()"
                type="button"
                *ngIf="collectingPositions">
                <fa-icon [icon]="faCheck" class="siimple--mr-1"></fa-icon>
                Finish
            </button>
        </div>
    </div>
</div>

<app-delete-modal 
    [(visible)]="deleteModalVisible"
    title='Stop tracking'
    body='This will stop tracking and remove existing positions. Are you sure you want to proceed?'
    (deleted)="disableTrackingAndClearPositions()"
    (canceled)="toggleDeleteModal()"
    >
</app-delete-modal>